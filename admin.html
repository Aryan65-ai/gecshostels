<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin ‚Ä¢ Government Engineering College Hostel</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" type="image/png" href="https://i.ibb.co/Lh5yXwk8/download-1.png">
</head>

<body>
  <header class="site-header">
    <div class="header-inner">
      <div class="brand">
        <img class="brand-logo" alt="GEC Hostel" src="https://i.ibb.co/Lh5yXwk8/download-1.png" />
        <span class="brand-title">GEC Samastipur Hostel</span>
      </div>
      <nav class="nav">
        <a href="home.html" class="nav-link">Home</a>
        <a href="hostel.html" class="nav-link">Hostel</a>
        <a href="payment.html" class="nav-link">Payment</a>
        <a href="about.html" class="nav-link">About</a>
        <a href="student-profile.html" class="nav-link">Profile</a>
        <a href="admin.html" class="nav-link active">Admin</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="admin-login-wrapper" id="admin-login-card">
      <section class="card">
        <h2>Administrator Login</h2>
        <form id="adminLoginForm" class="form">
          <div class="grid two">
            <div>
              <label for="adminUser">Username</label>
              <input type="text" id="adminUser" required placeholder="Enter username">
            </div>
            <div>
              <label for="adminPass">Password</label>
              <input type="password" id="adminPass" required placeholder="Enter password">
            </div>
          </div>
          <button type="submit" class="btn primary">Sign in</button>
          <p id="adminLoginMsg" class="muted"></p>
        </form>
      </section>
    </div>

    <section class="hidden" id="admin-dashboard">
      <div class="admin-dashboard-header">
        <h2>Dashboard</h2>
        <button type="button" class="btn-logout" id="adminLogout">Log out</button>
      </div>

      <div class="card admin-section">
        <h3 class="admin-section-title"><span class="icon">‚ö°</span> Quick actions</h3>
        <div class="grid two">
          <div class="fee-card">
            <h4 style="margin-top:0;">Post Notice</h4>
            <form id="postNoticeForm" class="form">
              <label for="noticeText">Notice</label>
              <textarea id="noticeText" rows="3" placeholder="Type your notice here‚Ä¶"></textarea>
              <button type="submit" class="btn primary">Publish</button>
              <p class="muted" style="margin-top:12px;margin-bottom:0;">Stored in browser (demo).</p>
            </form>
          </div>
          <div class="fee-card">
            <h4 style="margin-top:0;">Update Fees</h4>
            <form id="updateFeesForm" class="form">
              <label for="messFee">Mess Fee (per month)</label>
              <input type="text" id="messFee" placeholder="‚Çπ 3,500">
              <label for="singleFee">Single (per year)</label>
              <input type="text" id="singleFee" placeholder="‚Çπ 18,000">
              <label for="tripleFee">Triple (per year)</label>
              <input type="text" id="tripleFee" placeholder="‚Çπ 15,000">
              <button type="submit" class="btn primary">Save</button>
            </form>
          </div>
        </div>
      </div>

      <div class="card admin-section" style="margin-top:16px">
        <h3 class="admin-section-title"><span class="icon">üè†</span> Room Management</h3>
        <div class="grid two">
          <div class="fee-card">
            <h4 style="margin-top:0;">Add / Update Room</h4>
            <form id="addRoomForm" class="form">
              <div class="grid two" style="gap:10px">
                <div>
                  <label for="roomFloor">Floor</label>
                  <select id="roomFloor" required>
                    <option value="1">Floor 1</option>
                    <option value="2">Floor 2</option>
                    <option value="3">Floor 3</option>
                    <option value="4">Floor 4</option>
                  </select>
                </div>
                <div>
                  <label for="roomNumber">Room Number</label>
                  <input type="text" id="roomNumber" required placeholder="e.g. 101, 205">
                </div>
              </div>
              <label for="roomType">Room Type</label>
              <select id="roomType" required>
                <option value="single">Single</option>
                <option value="triple">Triple</option>
              </select>
              <div style="margin-top:10px;">
                <label><input type="checkbox" id="roomAvailable" checked> Available</label>
              </div>
              <button type="submit" class="btn primary" style="margin-top:10px;">Add Room</button>
            </form>
          </div>
          <div class="fee-card">
            <h4 style="margin-top:0;">Room Statistics</h4>
            <div class="grid two" style="gap:8px">
              <p><strong>Total Rooms:</strong> <span id="statTotalRooms">0</span></p>
              <p><strong>Available:</strong> <span id="statAvailableRooms" style="color:#10b981">0</span></p>
              <p><strong>Occupied:</strong> <span id="statOccupiedRooms" style="color:#ef4444">0</span></p>
              <p><strong>Single:</strong> <span id="statSingleRooms">0</span></p>
              <p><strong>Triple:</strong> <span id="statTripleRooms">0</span></p>
            </div>
          </div>
        </div>
        <div style="margin-top:16px">
          <h4>üîç Filter Rooms</h4>
          <div class="grid two" style="gap:10px; margin-bottom:10px;">
            <div>
              <label for="filterRoomFloor">Floor</label>
              <select id="filterRoomFloor">
                <option value="">All Floors</option>
                <option value="1">Floor 1</option>
                <option value="2">Floor 2</option>
                <option value="3">Floor 3</option>
                <option value="4">Floor 4</option>
              </select>
            </div>
            <div>
              <label for="filterRoomType">Type</label>
              <select id="filterRoomType">
                <option value="">All Types</option>
                <option value="single">Single</option>
                <option value="triple">Triple</option>
              </select>
            </div>
          </div>
          <div id="adminRoomsTable">
            <p class="muted">Loading rooms‚Ä¶</p>
          </div>
        </div>
      </div>
      <div class="card admin-section" style="margin-top:16px">
        <h3 class="admin-section-title"><span class="icon">üì±</span> Payment Information</h3>
        <div class="admin-upi-block">
          <p class="muted" style="margin:0;">Admin UPI ID</p>
          <p class="upi-id">7782891946@paytm</p>
          <p class="hint">Students use this UPI ID to pay the hostel admin. Shown on the payment page.</p>
        </div>
      </div>

      <div class="card admin-section" style="margin-top:16px">
        <h3 class="admin-section-title"><span class="icon">‚è≥</span> Pending Payment Confirmations</h3>
        <div id="pendingPaymentsList">
          <p class="muted">No pending payments</p>
        </div>
        <div class="admin-actions-row">
          <button class="btn primary" id="refreshPendingPayments">Refresh</button>
        </div>
      </div>

      <div class="card admin-section" style="margin-top:16px">
        <h3 class="admin-section-title"><span class="icon">üñº</span> Payment Screenshots Gallery</h3>
        <div id="screenshotsGallery">
          <p class="muted">No screenshots uploaded yet</p>
        </div>
        <div class="admin-actions-row">
          <button class="btn primary" id="refreshScreenshots">Refresh Gallery</button>
        </div>
      </div>

      <div class="card admin-section" style="margin-top:16px">
        <h3 class="admin-section-title"><span class="icon">üìã</span> i-Complain Management</h3>
        <div class="fee-card">
          <h4>Complaint Statistics</h4>
          <div class="grid two">
            <div>
              <p><strong>Total Complaints:</strong> <span id="totalComplaints">0</span></p>
              <p><strong>Pending:</strong> <span id="pendingComplaints">0</span></p>
              <p><strong>In Progress:</strong> <span id="inProgressComplaints">0</span></p>
            </div>
            <div>
              <p><strong>Resolved:</strong> <span id="resolvedComplaints">0</span></p>
              <p><strong>High Priority:</strong> <span id="highPriorityComplaints">0</span></p>
              <p><strong>Today's Complaints:</strong> <span id="todayComplaints">0</span></p>
            </div>
          </div>
        </div>

        <div class="fee-card" style="margin-top: 16px;">
          <h4>üîç Filter Complaints</h4>
          <div class="form-row">
            <div class="form-group">
              <label for="complaintStatusFilter">Status</label>
              <select id="complaintStatusFilter">
                <option value="">All Status</option>
                <option value="pending">Pending</option>
                <option value="in_progress">In Progress</option>
                <option value="resolved">Resolved</option>
                <option value="closed">Closed</option>
              </select>
            </div>
            <div class="form-group">
              <label for="complaintCategoryFilter">Category</label>
              <select id="complaintCategoryFilter">
                <option value="">All Categories</option>
                <option value="maintenance">Maintenance</option>
                <option value="mess">Mess</option>
                <option value="security">Security</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="form-group">
              <label for="complaintPriorityFilter">Priority</label>
              <select id="complaintPriorityFilter">
                <option value="">All Priorities</option>
                <option value="high">High</option>
                <option value="medium">Medium</option>
                <option value="low">Low</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <input type="text" id="complaintSearch" placeholder="Search by student ID, ticket number, or description"
              style="width: 100%; margin-bottom: 10px;">
          </div>
          <div class="admin-actions-row">
            <button class="btn primary" onclick="filterComplaints()">Filter</button>
            <button class="btn" onclick="clearComplaintFilters()">Clear Filters</button>
          </div>
        </div>

        <div id="complaintsList" style="margin-top: 20px;">
          <h4>üìã Complaints List</h4>
          <div id="complaintsTable">
            <p class="muted">No complaints found. Use filters to find complaints.</p>
          </div>
        </div>
      </div>

      <div class="card admin-section" style="margin-top:16px">
        <h3 class="admin-section-title"><span class="icon">üë•</span> Student Management</h3>
        <div class="fee-card">
          <h4>Student Statistics</h4>
          <div class="grid two">
            <div>
              <p><strong>Total Students:</strong> <span id="totalStudents">0</span></p>
              <p><strong>Boys Hostel:</strong> <span id="boysCount">0</span></p>
              <p><strong>Girls Hostel:</strong> <span id="girlsCount">0</span></p>
            </div>
            <div>
              <p><strong>Recent Registrations:</strong> <span id="recentRegistrations">0</span></p>
              <p><strong>Active Students:</strong> <span id="activeStudents">0</span></p>
            </div>
          </div>
        </div>

        <div class="fee-card" style="margin-top: 16px;">
          <h4>üîç Search Students</h4>
          <div class="form-group">
            <input type="text" id="studentSearch" placeholder="Search by name, student ID, roll number, or branch"
              style="width: 100%; margin-bottom: 10px;">
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="filterHostel">Filter by Hostel</label>
              <select id="filterHostel">
                <option value="">All Hostels</option>
                <option value="boys">Boys Hostel</option>
                <option value="girls">Girls Hostel</option>
              </select>
            </div>
            <div class="form-group">
              <label for="filterBranch">Filter by Branch</label>
              <select id="filterBranch">
                <option value="">All Branches</option>
                <option value="CSE">Computer Science Engineering</option>
                <option value="ECE">Electronics & Communication Engineering</option>
                <option value="EE">Electrical Engineering</option>
                <option value="ME">Mechanical Engineering</option>
                <option value="CE">Civil Engineering</option>
                <option value="IT">Information Technology</option>
                <option value="AE">Aerospace Engineering</option>
                <option value="CHE">Chemical Engineering</option>
              </select>
            </div>
          </div>
          <div class="admin-actions-row">
            <button class="btn primary" onclick="searchStudents()">Search</button>
            <button class="btn" onclick="clearFilters()">Clear Filters</button>
          </div>
        </div>

        <div id="studentsList" style="margin-top: 20px;">
          <h4>üìã Student List</h4>
          <div id="studentsTable">
            <p class="muted">No students found. Use search to find students.</p>
          </div>
        </div>
      </div>

      <div class="card admin-section" style="margin-top:16px">
        <h3 class="admin-section-title"><span class="icon">üìä</span> Payment Statistics</h3>
        <div class="admin-stat-grid">
          <div class="admin-stat-card">
            <h4>Total Revenue</h4>
            <p id="totalRevenue" class="value">‚Çπ0</p>
          </div>
          <div class="admin-stat-card">
            <h4>Total Transactions</h4>
            <p id="totalTransactions" class="value muted">0</p>
          </div>
          <div class="admin-stat-card">
            <h4>This Month</h4>
            <p id="monthlyRevenue" class="value">‚Çπ0</p>
          </div>
          <div class="admin-stat-card">
            <h4>Pending</h4>
            <p id="pendingPayments" class="value muted">0</p>
          </div>
        </div>
      </div>

      <div class="card admin-section" style="margin-top:16px">
        <h3 class="admin-section-title"><span class="icon">üìú</span> Logs</h3>
        <p class="muted" style="margin-bottom:16px;">Student sign-up, sign-in, admin login, and payments.</p>
        <div class="grid two admin-logs-grid">
          <div class="fee-card">
            <h4 style="margin-top:0;">Signups</h4>
            <div class="admin-actions-row">
              <button class="btn" id="clearSignups">Clear</button>
            </div>
            <div id="tableSignups"></div>
          </div>
          <div class="fee-card">
            <h4 style="margin-top:0;">Sign-ins</h4>
            <div class="admin-actions-row">
              <button class="btn" id="clearSignins">Clear</button>
            </div>
            <div id="tableSignins"></div>
          </div>
        </div>
        <div class="grid two admin-logs-grid">
          <div class="fee-card">
            <h4 style="margin-top:0;">Admin logins</h4>
            <div class="admin-actions-row">
              <button class="btn" id="clearAdminLogins">Clear</button>
            </div>
            <div id="tableAdminLogins"></div>
          </div>
          <div class="fee-card">
            <h4 style="margin-top:0;">Payments</h4>
            <div class="admin-actions-row">
              <button class="btn" id="clearPayments">Clear</button>
              <button class="btn primary" id="exportPayments">Export CSV</button>
            </div>
            <div id="tablePayments"></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <span>&copy; <span id="year"></span> Government Engineering College Samastipur Hostel</span>
    </div>
  </footer>

  <script>
    (function () {
      const loginForm = document.getElementById('adminLoginForm');
      const loginMsg = document.getElementById('adminLoginMsg');
      const card = document.getElementById('admin-login-card');
      const dash = document.getElementById('admin-dashboard');
      const yearEl = document.getElementById('year');
      if (yearEl) { yearEl.textContent = String(new Date().getFullYear()); }
      let state = { notices: [], fees: { mess: '‚Çπ 3,500 / month', single: '‚Çπ 18,000 / year', triple: '‚Çπ 15,000 / year' } };

      function getStore(key, fallback) {
        try { const v = localStorage.getItem(key); return v ? JSON.parse(v) : fallback; } catch (e) { return fallback; }
      }
      function setStore(key, value) { try { localStorage.setItem(key, JSON.stringify(value)); } catch (e) { } }
      function appendLog(key, entry) { const list = getStore(key, []); list.push({ time: new Date().toISOString(), ...entry }); setStore(key, list); }
      function renderTable(containerId, rows) {
        const el = document.getElementById(containerId);
        if (!el) { return }
        if (!rows || rows.length === 0) { el.innerHTML = '<p class="muted">No data</p>'; return; }
        const cols = Object.keys(rows[0]);
        let html = '<div class="admin-table-wrap"><table><thead><tr>';
        html += cols.map(c => '<th>' + c + '</th>').join('') + '</tr></thead><tbody>';
        html += rows.map(r => '<tr>' + cols.map(c => '<td>' + String(r[c]) + '</td>').join('') + '</tr>').join('') + '</tbody></table></div>';
        el.innerHTML = html;
      }
      function renderPaymentsTable(containerId, payments) {
        const el = document.getElementById(containerId);
        if (!el) { return }
        if (!payments || payments.length === 0) { el.innerHTML = '<p class="muted">No data</p>'; return; }
        const cols = ['Date', 'Student', 'Amount', 'Type', 'Status'];
        let html = '<div class="admin-table-wrap admin-table-scroll"><table><thead><tr>';
        html += cols.map(c => '<th>' + c + '</th>').join('') + '</tr></thead><tbody>';
        payments.forEach(function (p) {
          const date = p.timestamp ? new Date(p.timestamp).toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' }) : '‚Äî';
          const student = (p.studentName || '').trim() ? (p.studentName + (p.studentId ? ' (' + p.studentId + ')' : '')) : (p.studentId || '‚Äî');
          const studentShort = student.length > 24 ? student.slice(0, 21) + '‚Ä¶' : student;
          const amount = '‚Çπ' + (p.amount != null ? Number(p.amount).toLocaleString() : '0');
          const type = (p.feeType || '‚Äî').replace(/_/g, ' ');
          const status = (p.status || '‚Äî');
          html += '<tr><td>' + date + '</td><td title="' + student.replace(/"/g, '&quot;') + '">' + studentShort + '</td><td>' + amount + '</td><td>' + type + '</td><td>' + status + '</td></tr>';
        });
        html += '</tbody></table></div>';
        el.innerHTML = html;
      }
      loginForm.addEventListener('submit', function (e) {
        e.preventDefault();
        const u = document.getElementById('adminUser').value.trim();
        const p = document.getElementById('adminPass').value.trim();
        if (u === 'admin' && p === 'admin') {
          appendLog('admin_logins', { user: u, success: true });
          loginMsg.textContent = 'Login successful.'; loginMsg.style.color = '#10b981';
          card.classList.add('hidden');
          dash.classList.remove('hidden');
          loadAllTables();
          loadCurrentFees();
          loadComplaintStatistics();
          loadStudentStatistics();
          filterComplaints();
          renderAdminRooms();
          updateRoomStats();
        } else {
          loginMsg.textContent = 'Invalid. Hint: admin/admin'; loginMsg.style.color = '#ef4444';
        }
      });

      document.getElementById('adminLogout').addEventListener('click', function () {
        dash.classList.add('hidden');
        card.classList.remove('hidden');
        loginMsg.textContent = '';
        document.getElementById('adminPass').value = '';
      });

      const postNoticeForm = document.getElementById('postNoticeForm');
      postNoticeForm.addEventListener('submit', function (e) {
        e.preventDefault();
        const txt = document.getElementById('noticeText').value.trim();
        if (!txt) { return; }
        const all = getStore('notices', []);
        all.push({ id: Date.now(), text: txt });
        setStore('notices', all);
        alert('Notice published.');
        loadAllTables();
        postNoticeForm.reset();
      });

      // Load current fees into form
      function loadCurrentFees() {
        const fees = getStore('fees', {
          mess: '‚Çπ 3,500 / month',
          single: '‚Çπ 18,000 / year',
          triple: '‚Çπ 15,000 / year'
        });

        document.getElementById('messFee').value = fees.mess;
        document.getElementById('singleFee').value = fees.single;
        document.getElementById('tripleFee').value = fees.triple;
      }

      const updateFeesForm = document.getElementById('updateFeesForm');
      updateFeesForm.addEventListener('submit', function (e) {
        e.preventDefault();
        const mess = document.getElementById('messFee').value.trim() || '‚Çπ 3,500 / month';
        const single = document.getElementById('singleFee').value.trim() || '‚Çπ 18,000 / year';
        const triple = document.getElementById('tripleFee').value.trim() || '‚Çπ 15,000 / year';
        setStore('fees', { mess, single, triple });
        alert('Fees updated successfully! Payment gateway will now use the new amounts.');
        loadAllTables();
        loadCurrentFees(); // Reload to show updated values
      });

      function loadAllTables() {
        renderTable('tableSignups', getStore('signups', []));
        renderTable('tableSignins', getStore('sign_in_logs', []));
        renderTable('tableAdminLogins', getStore('admin_logins', []));
        renderPaymentsTable('tablePayments', getStore('payments', []));
        updatePaymentStatistics();
        loadPendingPayments();
        loadScreenshotsGallery();
        renderAdminRooms();
        updateRoomStats();
      }

      // ‚îÄ‚îÄ Room Management ‚îÄ‚îÄ
      function getDefaultRooms() {
        const rooms = [];
        for (let floor = 1; floor <= 4; floor++) {
          for (let i = 1; i <= 10; i++) {
            const capacity = i % 3 === 0 ? 3 : 1;
            rooms.push({ floor, room: `${floor}0${i}`, type: capacity === 1 ? 'single' : 'triple', available: true });
          }
        }
        return rooms;
      }

      function getRooms() {
        return getStore('hostel_rooms', getDefaultRooms());
      }

      function saveRooms(rooms) {
        setStore('hostel_rooms', rooms);
      }

      function updateRoomStats() {
        const rooms = getRooms();
        const el = (id) => document.getElementById(id);
        if (el('statTotalRooms')) el('statTotalRooms').textContent = rooms.length;
        if (el('statAvailableRooms')) el('statAvailableRooms').textContent = rooms.filter(r => r.available).length;
        if (el('statOccupiedRooms')) el('statOccupiedRooms').textContent = rooms.filter(r => !r.available).length;
        if (el('statSingleRooms')) el('statSingleRooms').textContent = rooms.filter(r => r.type === 'single').length;
        if (el('statTripleRooms')) el('statTripleRooms').textContent = rooms.filter(r => r.type === 'triple').length;
      }

      function renderAdminRooms() {
        const container = document.getElementById('adminRoomsTable');
        if (!container) return;
        const rooms = getRooms();
        const floorFilter = document.getElementById('filterRoomFloor').value;
        const typeFilter = document.getElementById('filterRoomType').value;

        let filtered = rooms;
        if (floorFilter) filtered = filtered.filter(r => String(r.floor) === floorFilter);
        if (typeFilter) filtered = filtered.filter(r => r.type === typeFilter);

        // Sort by floor then room number
        filtered.sort((a, b) => a.floor - b.floor || String(a.room).localeCompare(String(b.room)));

        if (filtered.length === 0) {
          container.innerHTML = '<p class="muted">No rooms match the current filter.</p>';
          return;
        }

        let html = '<div class="admin-table-wrap"><table><thead><tr>';
        html += '<th>Room</th><th>Floor</th><th>Type</th><th>Status</th><th>Actions</th>';
        html += '</tr></thead><tbody>';
        filtered.forEach(r => {
          const statusColor = r.available ? '#10b981' : '#ef4444';
          const statusText = r.available ? 'Available' : 'Occupied';
          const toggleLabel = r.available ? 'üîí Set Occupied' : 'üîì Set Available';
          html += '<tr>';
          html += `<td><strong>${r.room}</strong></td>`;
          html += `<td>Floor ${r.floor}</td>`;
          html += `<td style="text-transform:capitalize">${r.type}</td>`;
          html += `<td><span style="color:${statusColor};font-weight:600;">${statusText}</span></td>`;
          html += `<td><div class="admin-actions-row" style="margin:0;">`;
          html += `<button class="btn" onclick="toggleRoomAvail('${r.room}')" style="padding:4px 8px;font-size:12px;">${toggleLabel}</button>`;
          html += `<button class="btn" onclick="deleteRoom('${r.room}')" style="padding:4px 8px;font-size:12px;color:#ef4444;">üóë Delete</button>`;
          html += `</div></td>`;
          html += '</tr>';
        });
        html += '</tbody></table></div>';
        container.innerHTML = html;
      }

      function toggleRoomAvail(roomId) {
        const rooms = getRooms();
        const room = rooms.find(r => r.room === roomId);
        if (room) {
          room.available = !room.available;
          saveRooms(rooms);
          renderAdminRooms();
          updateRoomStats();
        }
      }

      function deleteRoom(roomId) {
        if (!confirm('Delete room ' + roomId + '? This cannot be undone.')) return;
        let rooms = getRooms();
        rooms = rooms.filter(r => r.room !== roomId);
        saveRooms(rooms);
        renderAdminRooms();
        updateRoomStats();
      }

      // Add room form
      const addRoomForm = document.getElementById('addRoomForm');
      addRoomForm.addEventListener('submit', function (e) {
        e.preventDefault();
        const floor = Number(document.getElementById('roomFloor').value);
        const roomNum = document.getElementById('roomNumber').value.trim();
        const type = document.getElementById('roomType').value;
        const available = document.getElementById('roomAvailable').checked;
        if (!roomNum) { alert('Please enter a room number.'); return; }
        const rooms = getRooms();
        const existing = rooms.findIndex(r => r.room === roomNum);
        if (existing !== -1) {
          // Update existing room
          rooms[existing].floor = floor;
          rooms[existing].type = type;
          rooms[existing].available = available;
          saveRooms(rooms);
          alert('Room ' + roomNum + ' updated successfully!');
        } else {
          // Add new room
          rooms.push({ floor, room: roomNum, type, available });
          saveRooms(rooms);
          alert('Room ' + roomNum + ' added successfully!');
        }
        renderAdminRooms();
        updateRoomStats();
        addRoomForm.reset();
        document.getElementById('roomAvailable').checked = true;
      });

      // Room filter listeners
      document.getElementById('filterRoomFloor').addEventListener('change', renderAdminRooms);
      document.getElementById('filterRoomType').addEventListener('change', renderAdminRooms);

      function loadPendingPayments() {
        const payments = getStore('payments', []);
        const pendingPayments = payments.filter(payment => payment.status === 'pending');
        const container = document.getElementById('pendingPaymentsList');

        if (pendingPayments.length === 0) {
          container.innerHTML = '<p class="muted">No pending payments</p>';
          return;
        }

        let html = '';
        pendingPayments.forEach(payment => {
          html += `
            <div class="pending-payment-card">
              <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 16px;">
                <div style="flex: 1; min-width: 200px;">
                  <h4 style="margin: 0 0 8px 0;">${payment.studentName} (${payment.studentId})</h4>
                  <p><strong>Amount:</strong> ‚Çπ${(payment.amount || 0).toLocaleString()}</p>
                  <p><strong>Fee Type:</strong> ${payment.feeType}</p>
                  <p><strong>Payment Method:</strong> ${payment.paymentMethod}</p>
                  <p><strong>Date:</strong> ${new Date(payment.timestamp).toLocaleDateString()}</p>
                  <p><strong>Transaction ID:</strong> ${payment.transactionId}</p>
                  ${payment.adminUpiId ? `<p><strong>Admin UPI:</strong> ${payment.adminUpiId}</p>` : ''}
                  ${payment.screenshotUploaded ? '<p style="color: #10b981;"><strong>üì∑ Screenshot uploaded</strong></p>' : ''}
                  
                  ${payment.screenshotUploaded ? `
                    <div style="margin-top: 12px;">
                      <h5>üì∑ Payment Screenshot:</h5>
                      <div style="border: 1px solid var(--border); border-radius: 8px; padding: 8px; background: #0d152a;">
                        <img src="${payment.screenshotData || '#'}" 
                             alt="Payment Screenshot" 
                             style="max-width: 100%; max-height: 200px; border-radius: 4px; cursor: pointer;"
                             onclick="viewScreenshot('${payment.transactionId}')"
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <p style="display: none; color: var(--muted); text-align: center; margin: 8px 0;">Screenshot not available</p>
                        <button class="btn" onclick="viewScreenshot('${payment.transactionId}')" style="margin-top: 8px; width: 100%;">
                          üîç View Full Screenshot
                        </button>
                      </div>
                    </div>
                  ` : `
                    <div style="margin-top: 12px; padding: 8px; background: #1a1a2e; border-radius: 6px; border: 1px solid #ffa500;">
                      <p style="margin: 0; color: #ffa500; font-weight: bold;">‚ö†Ô∏è No screenshot uploaded</p>
                      <small style="color: var(--muted);">Student did not upload payment proof</small>
                    </div>
                  `}
                </div>
                
                <div class="payment-actions">
                  <button class="btn primary" onclick="confirmPayment('${payment.transactionId}')">‚úÖ Confirm</button>
                  <button class="btn" onclick="rejectPayment('${payment.transactionId}')">‚ùå Reject</button>
                  <button class="btn" onclick="requestScreenshot('${payment.transactionId}')">üì∑ Request Screenshot</button>
                </div>
              </div>
            </div>
          `;
        });

        container.innerHTML = html;
      }

      function confirmPayment(transactionId) {
        const payments = getStore('payments', []);
        const paymentIndex = payments.findIndex(p => p.transactionId === transactionId);

        if (paymentIndex !== -1) {
          payments[paymentIndex].status = 'completed';
          payments[paymentIndex].confirmedAt = new Date().toISOString();
          payments[paymentIndex].confirmedBy = 'admin';

          setStore('payments', payments);
          alert('Payment confirmed successfully!');
          loadAllTables();
        }
      }

      function rejectPayment(transactionId) {
        const payments = getStore('payments', []);
        const paymentIndex = payments.findIndex(p => p.transactionId === transactionId);

        if (paymentIndex !== -1) {
          payments[paymentIndex].status = 'rejected';
          payments[paymentIndex].rejectedAt = new Date().toISOString();
          payments[paymentIndex].rejectedBy = 'admin';

          setStore('payments', payments);
          alert('Payment rejected!');
          loadAllTables();
        }
      }

      function viewScreenshot(transactionId) {
        const payments = getStore('payments', []);
        const payment = payments.find(p => p.transactionId === transactionId);

        if (payment && payment.screenshotData) {
          // Create a modal to view the screenshot
          const modal = document.createElement('div');
          modal.style.cssText = `
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); z-index: 1000; display: flex; 
            align-items: center; justify-content: center; padding: 20px;
          `;

          modal.innerHTML = `
            <div style="background: var(--card); border-radius: 12px; padding: 20px; max-width: 90%; max-height: 90%; position: relative;">
              <button onclick="this.parentElement.parentElement.remove()" 
                      style="position: absolute; top: 10px; right: 10px; background: #ef4444; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer;">√ó</button>
              <h3 style="margin: 0 0 15px 0;">Payment Screenshot - ${payment.studentName}</h3>
              <img src="${payment.screenshotData}" 
                   alt="Payment Screenshot" 
                   style="max-width: 100%; max-height: 70vh; border-radius: 8px; border: 1px solid var(--border);">
              <div style="margin-top: 15px; text-align: center;">
                <p><strong>Transaction ID:</strong> ${transactionId}</p>
                <p><strong>Amount:</strong> ‚Çπ${(payment.amount || 0).toLocaleString()}</p>
                <p><strong>Date:</strong> ${new Date(payment.timestamp).toLocaleDateString()}</p>
              </div>
            </div>
          `;

          document.body.appendChild(modal);

          // Close modal when clicking outside
          modal.addEventListener('click', (e) => {
            if (e.target === modal) {
              modal.remove();
            }
          });
        } else {
          alert('Screenshot not available for this payment.');
        }
      }

      function requestScreenshot(transactionId) {
        const payments = getStore('payments', []);
        const payment = payments.find(p => p.transactionId === transactionId);

        if (payment) {
          alert(`Screenshot request logged for ${payment.studentName} (${payment.studentId}). Student will be notified to upload payment proof.`);
        }
      }

      // Make functions globally accessible
      window.confirmPayment = confirmPayment;
      window.rejectPayment = rejectPayment;
      window.viewScreenshot = viewScreenshot;
      window.requestScreenshot = requestScreenshot;
      window.viewStudentDetails = viewStudentDetails;
      window.editStudent = editStudent;
      window.searchStudents = searchStudents;
      window.clearFilters = clearFilters;
      window.filterComplaints = filterComplaints;
      window.clearComplaintFilters = clearComplaintFilters;
      window.viewComplaintDetails = viewComplaintDetails;
      window.updateComplaintStatus = updateComplaintStatus;
      window.toggleRoomAvail = toggleRoomAvail;
      window.deleteRoom = deleteRoom;

      function loadScreenshotsGallery() {
        const payments = getStore('payments', []);
        const paymentsWithScreenshots = payments.filter(payment => payment.screenshotUploaded && payment.screenshotData);
        const container = document.getElementById('screenshotsGallery');

        if (paymentsWithScreenshots.length === 0) {
          container.innerHTML = '<p class="muted">No screenshots uploaded yet</p>';
          return;
        }

        let html = '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 16px;">';

        paymentsWithScreenshots.forEach(payment => {
          html += `
            <div class="fee-card" style="padding: 12px;">
              <div style="text-align: center;">
                <img src="${payment.screenshotData}" 
                     alt="Payment Screenshot" 
                     style="width: 100%; height: 150px; object-fit: cover; border-radius: 6px; border: 1px solid var(--border); cursor: pointer;"
                     onclick="viewScreenshot('${payment.transactionId}')">
                <h5 style="margin: 8px 0 4px 0;">${payment.studentName}</h5>
                <p style="margin: 2px 0; color: var(--muted); font-size: 12px;">${payment.studentId}</p>
                <p style="margin: 2px 0; color: var(--primary); font-weight: bold;">‚Çπ${(payment.amount || 0).toLocaleString()}</p>
                <p style="margin: 2px 0; color: var(--muted); font-size: 11px;">${new Date(payment.timestamp).toLocaleDateString()}</p>
                <div style="margin-top: 8px;">
                  <span style="background: ${payment.status === 'completed' ? '#10b981' : payment.status === 'pending' ? '#ffa500' : '#ef4444'}; color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">
                    ${payment.status.toUpperCase()}
                  </span>
                </div>
              </div>
            </div>
          `;
        });

        html += '</div>';
        container.innerHTML = html;
      }

      function updatePaymentStatistics() {
        const payments = getStore('payments', []);
        const totalRevenue = payments.reduce((sum, payment) => sum + (payment.amount || 0), 0);
        const totalTransactions = payments.length;

        // Calculate monthly revenue
        const currentMonth = new Date().getMonth();
        const currentYear = new Date().getFullYear();
        const monthlyRevenue = payments
          .filter(payment => {
            const paymentDate = new Date(payment.timestamp);
            return paymentDate.getMonth() === currentMonth && paymentDate.getFullYear() === currentYear;
          })
          .reduce((sum, payment) => sum + (payment.amount || 0), 0);

        // Count pending payments
        const pendingPayments = payments.filter(payment => payment.status === 'pending').length;

        document.getElementById('totalRevenue').textContent = '‚Çπ' + totalRevenue.toLocaleString();
        document.getElementById('totalTransactions').textContent = totalTransactions.toString();
        document.getElementById('monthlyRevenue').textContent = '‚Çπ' + monthlyRevenue.toLocaleString();
        document.getElementById('pendingPayments').textContent = pendingPayments.toString();
      }

      function exportPaymentsToCSV() {
        const payments = getStore('payments', []);
        if (payments.length === 0) {
          alert('No payment data to export');
          return;
        }

        const escCsv = (val) => {
          const s = String(val || '');
          if (s.includes(',') || s.includes('"') || s.includes('\n')) {
            return '"' + s.replace(/"/g, '""') + '"';
          }
          return s;
        };
        const headers = ['Transaction ID', 'Student Name', 'Student ID', 'Email', 'Phone', 'Fee Type', 'Amount', 'Payment Method', 'Status', 'Date'];
        const csvContent = [
          headers.join(','),
          ...payments.map(payment => [
            escCsv(payment.transactionId),
            escCsv(payment.studentName),
            escCsv(payment.studentId),
            escCsv(payment.email),
            escCsv(payment.phone),
            escCsv(payment.feeType),
            escCsv(payment.amount),
            escCsv(payment.paymentMethod),
            escCsv(payment.status),
            escCsv(payment.timestamp ? new Date(payment.timestamp).toLocaleDateString() : '')
          ].join(','))
        ].join('\n');

        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `payments_${new Date().toISOString().split('T')[0]}.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      }
      function clearAndReload(key) { localStorage.removeItem(key); loadAllTables(); }
      document.getElementById('clearSignups').addEventListener('click', () => clearAndReload('signups'));
      document.getElementById('clearSignins').addEventListener('click', () => clearAndReload('sign_in_logs'));
      document.getElementById('clearAdminLogins').addEventListener('click', () => clearAndReload('admin_logins'));
      document.getElementById('clearPayments').addEventListener('click', () => clearAndReload('payments'));
      document.getElementById('exportPayments').addEventListener('click', () => exportPaymentsToCSV());
      document.getElementById('refreshPendingPayments').addEventListener('click', () => loadPendingPayments());
      document.getElementById('refreshScreenshots').addEventListener('click', () => loadScreenshotsGallery());

      // Student Management Functions
      function loadStudentStatistics() {
        const students = JSON.parse(localStorage.getItem('hostelUsers') || '[]');
        const totalStudents = students.length;
        const boysCount = students.filter(s => s.hostelType === 'boys').length;
        const girlsCount = students.filter(s => s.hostelType === 'girls').length;

        // Recent registrations (last 30 days)
        const thirtyDaysAgo = new Date();
        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
        const recentRegistrations = students.filter(s =>
          s.registrationDate && new Date(s.registrationDate) > thirtyDaysAgo
        ).length;

        document.getElementById('totalStudents').textContent = totalStudents;
        document.getElementById('boysCount').textContent = boysCount;
        document.getElementById('girlsCount').textContent = girlsCount;
        document.getElementById('recentRegistrations').textContent = recentRegistrations;
        document.getElementById('activeStudents').textContent = totalStudents; // Assuming all registered students are active
      }

      function searchStudents() {
        const students = JSON.parse(localStorage.getItem('hostelUsers') || '[]');
        const searchTerm = document.getElementById('studentSearch').value.toLowerCase();
        const hostelFilter = document.getElementById('filterHostel').value;
        const branchFilter = document.getElementById('filterBranch').value;

        let filteredStudents = students.filter(student => {
          const fName = (student.firstName || '').toLowerCase();
          const lName = (student.lastName || '').toLowerCase();
          const sId = (student.studentId || '').toLowerCase();
          const roll = (student.rollNumber || '').toLowerCase();
          const br = (student.branch || '').toLowerCase();
          const matchesSearch = !searchTerm ||
            fName.includes(searchTerm) ||
            lName.includes(searchTerm) ||
            sId.includes(searchTerm) ||
            roll.includes(searchTerm) ||
            br.includes(searchTerm);

          const matchesHostel = !hostelFilter || student.hostelType === hostelFilter;
          const matchesBranch = !branchFilter || student.branch === branchFilter;

          return matchesSearch && matchesHostel && matchesBranch;
        });

        displayStudents(filteredStudents);
      }

      function displayStudents(students) {
        const container = document.getElementById('studentsTable');

        if (students.length === 0) {
          container.innerHTML = '<p class="muted">No students found matching your criteria.</p>';
          return;
        }

        let html = '<div class="admin-table-wrap"><table><thead><tr>';
        html += '<th>Photo</th>';
        html += '<th>Name</th><th>Student ID</th><th>Roll No</th><th>Batch</th><th>Branch</th><th>Hostel</th><th>Room</th><th>Phone</th><th>Email</th><th>Actions</th>';
        html += '</tr></thead><tbody>';

        students.forEach(student => {
          const photoHtml = student.photo ?
            `<img src="${student.photo}" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">` :
            `<div style="width: 40px; height: 40px; border-radius: 50%; background: var(--primary); display: flex; align-items: center; justify-content: center; color: #062015; font-weight: bold;">${(student.firstName || '?')[0]}${(student.lastName || '?')[0]}</div>`;

          html += '<tr>';
          html += `<td>${photoHtml}</td>`;
          html += `<td>${student.firstName} ${student.lastName}</td>`;
          html += `<td>${student.studentId}</td>`;
          html += `<td>${student.rollNumber || 'N/A'}</td>`;
          html += `<td>${student.batch || 'N/A'}</td>`;
          html += `<td>${student.branch || 'N/A'}</td>`;
          html += `<td>${student.hostelType === 'boys' ? 'Boys' : 'Girls'}</td>`;
          html += `<td>${student.roomNumber || 'N/A'}</td>`;
          html += `<td>${student.phone}</td>`;
          html += `<td>${student.email}</td>`;
          html += `<td><div class="admin-actions-row" style="margin:0;"><button class="btn" onclick="viewStudentDetails('${student.studentId}')" style="padding: 4px 8px; font-size: 12px;">View</button><button class="btn" onclick="editStudent('${student.studentId}')" style="padding: 4px 8px; font-size: 12px;">Edit</button></div></td>`;
          html += '</tr>';
        });

        html += '</tbody></table></div>';
        container.innerHTML = html;
      }

      function clearFilters() {
        document.getElementById('studentSearch').value = '';
        document.getElementById('filterHostel').value = '';
        document.getElementById('filterBranch').value = '';
        searchStudents();
      }

      function viewStudentDetails(studentId) {
        const students = JSON.parse(localStorage.getItem('hostelUsers') || '[]');
        const student = students.find(s => s.studentId === studentId);

        if (student) {
          alert(`Student Details:\n\nName: ${student.firstName} ${student.lastName}\nStudent ID: ${student.studentId}\nRoll Number: ${student.rollNumber || 'N/A'}\nBatch: ${student.batch || 'N/A'}\nBranch: ${student.branch || 'N/A'}\nHostel: ${student.hostelType === 'boys' ? 'Boys Hostel' : 'Girls Hostel'}\nRoom: ${student.roomNumber || 'N/A'}\nPhone: ${student.phone}\nEmail: ${student.email}\nRegistration Date: ${student.registrationDate ? new Date(student.registrationDate).toLocaleDateString() : 'N/A'}`);
        }
      }

      function editStudent(studentId) {
        alert('Edit student functionality will be implemented soon!');
      }

      // Load student statistics on page load
      loadStudentStatistics();

      // Add event listeners for search
      document.getElementById('studentSearch').addEventListener('input', searchStudents);
      document.getElementById('filterHostel').addEventListener('change', searchStudents);
      document.getElementById('filterBranch').addEventListener('change', searchStudents);

      // Complaint Management Functions
      function loadComplaintStatistics() {
        const complaints = getStore('complaints', []);
        const totalComplaints = complaints.length;
        const pendingComplaints = complaints.filter(c => c.status === 'pending').length;
        const inProgressComplaints = complaints.filter(c => c.status === 'in_progress').length;
        const resolvedComplaints = complaints.filter(c => c.status === 'resolved').length;
        const highPriorityComplaints = complaints.filter(c => c.priority === 'high').length;

        // Today's complaints
        const today = new Date().toDateString();
        const todayComplaints = complaints.filter(c =>
          new Date(c.submittedAt).toDateString() === today
        ).length;

        document.getElementById('totalComplaints').textContent = totalComplaints;
        document.getElementById('pendingComplaints').textContent = pendingComplaints;
        document.getElementById('inProgressComplaints').textContent = inProgressComplaints;
        document.getElementById('resolvedComplaints').textContent = resolvedComplaints;
        document.getElementById('highPriorityComplaints').textContent = highPriorityComplaints;
        document.getElementById('todayComplaints').textContent = todayComplaints;
      }

      function filterComplaints() {
        const complaints = getStore('complaints', []);
        const statusFilter = document.getElementById('complaintStatusFilter').value;
        const categoryFilter = document.getElementById('complaintCategoryFilter').value;
        const priorityFilter = document.getElementById('complaintPriorityFilter').value;
        const searchTerm = document.getElementById('complaintSearch').value.toLowerCase();

        let filteredComplaints = complaints.filter(complaint => {
          const matchesStatus = !statusFilter || complaint.status === statusFilter;
          const matchesCategory = !categoryFilter || complaint.category === categoryFilter;
          const matchesPriority = !priorityFilter || complaint.priority === priorityFilter;
          const cStudentId = (complaint.studentId || '').toLowerCase();
          const cTicket = String(complaint.ticket || '');
          const cDesc = (complaint.description || '').toLowerCase();
          const matchesSearch = !searchTerm ||
            cStudentId.includes(searchTerm) ||
            cTicket.includes(searchTerm) ||
            cDesc.includes(searchTerm);

          return matchesStatus && matchesCategory && matchesPriority && matchesSearch;
        });

        displayComplaints(filteredComplaints);
      }

      function displayComplaints(complaints) {
        const container = document.getElementById('complaintsTable');

        if (complaints.length === 0) {
          container.innerHTML = '<p class="muted">No complaints found matching your criteria.</p>';
          return;
        }

        // Sort by priority and submission date
        complaints.sort((a, b) => {
          const priorityOrder = { high: 3, medium: 2, low: 1 };
          if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
            return priorityOrder[b.priority] - priorityOrder[a.priority];
          }
          return new Date(b.submittedAt) - new Date(a.submittedAt);
        });

        let html = '<div class="admin-table-wrap"><table><thead><tr>';
        html += '<th>Ticket #</th><th>Student ID</th><th>Category</th><th>Priority</th><th>Status</th><th>Description</th><th>Submitted</th><th>Actions</th>';
        html += '</tr></thead><tbody>';

        complaints.forEach(complaint => {
          const priorityColor = complaint.priority === 'high' ? '#ef4444' :
            complaint.priority === 'medium' ? '#f59e0b' : '#10b981';
          const statusColor = complaint.status === 'pending' ? '#f59e0b' :
            complaint.status === 'in_progress' ? '#3b82f6' :
              complaint.status === 'resolved' ? '#10b981' : '#6b7280';

          const statusClass = complaint.status === 'in_progress' ? 'in-progress' : complaint.status;
          html += '<tr>';
          html += `<td style="font-weight: bold;">#${complaint.ticket}</td>`;
          html += `<td>${complaint.studentId}</td>`;
          html += `<td style="text-transform: capitalize;">${complaint.category}</td>`;
          html += `<td><span class="admin-badge ${complaint.priority}">${complaint.priority}</span></td>`;
          html += `<td><span class="admin-badge ${statusClass}">${complaint.status.replace('_', ' ')}</span></td>`;
          html += `<td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${complaint.description.replace(/"/g, '&quot;')}">${complaint.description}</td>`;
          html += `<td>${new Date(complaint.submittedAt).toLocaleDateString()}</td>`;
          html += `<td><div class="admin-actions-row" style="margin:0;"><button class="btn" onclick="viewComplaintDetails(${complaint.ticket})" style="padding: 4px 8px; font-size: 12px;">View</button><button class="btn" onclick="updateComplaintStatus(${complaint.ticket})" style="padding: 4px 8px; font-size: 12px;">Update</button></div></td>`;
          html += '</tr>';
        });

        html += '</tbody></table></div>';
        container.innerHTML = html;
      }

      function clearComplaintFilters() {
        document.getElementById('complaintStatusFilter').value = '';
        document.getElementById('complaintCategoryFilter').value = '';
        document.getElementById('complaintPriorityFilter').value = '';
        document.getElementById('complaintSearch').value = '';
        filterComplaints();
      }

      function viewComplaintDetails(ticket) {
        const complaints = getStore('complaints', []);
        const complaint = complaints.find(c => c.ticket === ticket);

        if (complaint) {
          const student = JSON.parse(localStorage.getItem('hostelUsers') || '[]').find(s => s.studentId === complaint.studentId);
          const studentName = student ? `${student.firstName} ${student.lastName}` : 'Unknown Student';

          alert(`Complaint Details:\n\nTicket: #${complaint.ticket}\nStudent: ${studentName} (${complaint.studentId})\nCategory: ${complaint.category}\nPriority: ${complaint.priority}\nStatus: ${complaint.status}\nSubmitted: ${new Date(complaint.submittedAt).toLocaleString()}\n\nDescription:\n${complaint.description}`);
        }
      }

      function updateComplaintStatus(ticket) {
        const complaints = getStore('complaints', []);
        const complaint = complaints.find(c => c.ticket === ticket);

        if (complaint) {
          const newStatus = prompt(`Current Status: ${complaint.status}\n\nEnter new status (pending, in_progress, resolved, closed):`, complaint.status);
          if (newStatus && ['pending', 'in_progress', 'resolved', 'closed'].includes(newStatus)) {
            complaint.status = newStatus;
            if (newStatus === 'resolved' || newStatus === 'closed') {
              complaint.resolvedAt = new Date().toISOString();
            }
            setStore('complaints', complaints);
            loadComplaintStatistics();
            filterComplaints();
            alert(`Complaint #${ticket} status updated to ${newStatus}`);
          }
        }
      }

      // Load complaint statistics on page load
      loadComplaintStatistics();

      // Add event listeners for complaint filters
      document.getElementById('complaintSearch').addEventListener('input', filterComplaints);
      document.getElementById('complaintStatusFilter').addEventListener('change', filterComplaints);
      document.getElementById('complaintCategoryFilter').addEventListener('change', filterComplaints);
      document.getElementById('complaintPriorityFilter').addEventListener('change', filterComplaints);
    })();
  </script>
</body>

</html>